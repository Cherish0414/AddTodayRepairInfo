[33mcommit 5157537c547596970e6872750d5d9b5255d36c59[m[33m ([m[1;36mHEAD[m[33m -> [m[1;32mmain[m[33m, [m[1;33mtag: [m[1;33m1.0.1[m[33m, [m[1;33mtag: [m[1;33m1.0.0[m[33m, [m[1;31morigin/main[m[33m)[m
Author: å¼ . å­é“­ <oncwnuMgXJBWx78kgz1m9_AbPMd8@git.weixin.qq.com>
Date:   Tue Jan 20 11:51:33 2026 +0900

    initial commit

[1mdiff --git a/.gitignore b/.gitignore[m
[1mindex 5c692de..c38b1a2 100644[m
[1m--- a/.gitignore[m
[1m+++ b/.gitignore[m
[36m@@ -39,6 +39,9 @@[m [mnode_modules/[m
 bower_components/[m
 vendor/[m
 [m
[32m+[m[32m# Config files[m
[32m+[m[32mconfig.toml[m
[32m+[m
 # Other files[m
 *.sqlite3[m
 *.db[m
[36m@@ -55,4 +58,6 @@[m [mvendor/[m
 *.pickle[m
 *.json[m
 *.key[m
[32m+[m[32m*.ps1[m
[32m+[m[32m*.txt[m
 test.py[m
\ No newline at end of file[m
[1mdiff --git a/config/config.example.toml b/config/config.example.toml[m
[1mnew file mode 100644[m
[1mindex 0000000..f78c7ce[m
[1m--- /dev/null[m
[1m+++ b/config/config.example.toml[m
[36m@@ -0,0 +1,8 @@[m
[32m+[m[32m[database][m
[32m+[m[32mdriver = "mssql"[m
[32m+[m[32mhost = "127.0.0.1"[m
[32m+[m[32mport = 1433[m
[32m+[m[32mdatabase = "your_database"[m
[32m+[m[32musername = "your_user"[m
[32m+[m[32mpassword = "your_password"[m
[32m+[m[32mtimeout = 10[m
[1mdiff --git a/requirements.txt b/requirements.txt[m
[1mindex 5961823..7631aab 100644[m
[1m--- a/requirements.txt[m
[1m+++ b/requirements.txt[m
[36m@@ -1,7 +1,44 @@[m
 altgraph==0.17.5[m
[32m+[m[32mcachetools==6.2.4[m
[32m+[m[32mcertifi==2026.1.4[m
[32m+[m[32mcffi==2.0.0[m
[32m+[m[32mcharset-normalizer==3.4.4[m
[32m+[m[32mcryptography==46.0.3[m
[32m+[m[32met_xmlfile==2.0.0[m
[32m+[m[32mgoogle-api-core==2.29.0[m
[32m+[m[32mgoogle-api-python-client==2.187.0[m
[32m+[m[32mgoogle-auth==2.41.1[m
[32m+[m[32mgoogle-auth-httplib2==0.3.0[m
[32m+[m[32mgoogle-auth-oauthlib==1.2.3[m
[32m+[m[32mgoogleapis-common-protos==1.72.0[m
[32m+[m[32mhttplib2==0.31.0[m
[32m+[m[32midna==3.11[m
[32m+[m[32mnumpy==2.4.0[m
[32m+[m[32moauthlib==3.3.1[m
[32m+[m[32mopenpyxl==3.1.5[m
 packaging==25.0[m
[32m+[m[32mpandas==2.3.3[m
 pefile==2024.8.26[m
[32m+[m[32mproto-plus==1.27.0[m
[32m+[m[32mprotobuf==6.33.4[m
[32m+[m[32mpyasn1==0.6.1[m
[32m+[m[32mpyasn1_modules==0.4.2[m
[32m+[m[32mpycparser==2.23[m
[32m+[m[32mpycryptodomex==3.23.0[m
 pyinstaller==6.17.0[m
 pyinstaller-hooks-contrib==2025.11[m
[32m+[m[32mpyodbc==5.3.0[m
[32m+[m[32mpyparsing==3.3.1[m
[32m+[m[32mpython-dateutil==2.9.0.post0[m
[32m+[m[32mpytz==2025.2[m
 pywin32-ctypes==0.2.3[m
[32m+[m[32mpyzipper==0.3.6[m
[32m+[m[32mrequests==2.32.5[m
[32m+[m[32mrequests-oauthlib==2.0.0[m
[32m+[m[32mrsa==4.9.1[m
 setuptools==80.9.0[m
[32m+[m[32msix==1.17.0[m
[32m+[m[32mtzdata==2025.3[m
[32m+[m[32muritemplate==4.2.0[m
[32m+[m[32murllib3==2.6.3[m
[32m+[m[32mxlsxwriter==3.2.9[m
[1mdiff --git a/src/query_repair_info/__init__.py b/src/query_repair_info/__init__.py[m
[1mindex e69de29..d538f87 100644[m
[1m--- a/src/query_repair_info/__init__.py[m
[1m+++ b/src/query_repair_info/__init__.py[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32m__version__ = "1.0.0"[m
\ No newline at end of file[m
[1mdiff --git a/src/query_repair_info/__main__.py b/src/query_repair_info/__main__.py[m
[1mindex 5d6a810..3363ce5 100644[m
[1m--- a/src/query_repair_info/__main__.py[m
[1m+++ b/src/query_repair_info/__main__.py[m
[36m@@ -1,3 +1,6 @@[m
[31m-from .main import main[m
[32m+[m[32mfrom query_repair_info.main_download import download_and_decrypt[m
[32m+[m[32mfrom query_repair_info.main_upload import query_and_upload[m
 [m
[31m-main()[m
[32m+[m[32mif __name__ == "__main__":[m
[32m+[m[32m    #download_and_decrypt() # Use python -m query_repair_info to run[m
[32m+[m[32m    query_and_upload()[m
\ No newline at end of file[m
[1mdiff --git a/src/query_repair_info/config/__init__.py b/src/query_repair_info/config/__init__.py[m
[1mnew file mode 100644[m
[1mindex 0000000..6feadaa[m
[1m--- /dev/null[m
[1m+++ b/src/query_repair_info/config/__init__.py[m
[36m@@ -0,0 +1,2 @@[m
[32m+[m[32mfrom .config import config[m
[32m+[m[32m__all__ = ["config"][m
\ No newline at end of file[m
[1mdiff --git a/src/query_repair_info/config/config.py b/src/query_repair_info/config/config.py[m
[1mnew file mode 100644[m
[1mindex 0000000..d7b8046[m
[1m--- /dev/null[m
[1m+++ b/src/query_repair_info/config/config.py[m
[36m@@ -0,0 +1,107 @@[m
[32m+[m[32mimport tomllib[m
[32m+[m[32mfrom time import strftime, localtime[m
[32m+[m[32mimport os[m
[32m+[m[32mimport sys[m
[32m+[m[32mfrom pathlib import Path[m
[32m+[m
[32m+[m[32mdef get_base_dir() -> Path:[m
[32m+[m[32m    if getattr(sys, "frozen", False):[m
[32m+[m[32m        return Path(os.path.dirname(sys.executable))[m
[32m+[m[32m    else:[m
[32m+[m[32m        return Path(__file__).resolve().parents[3][m
[32m+[m
[32m+[m[32mBASE_DIR = get_base_dir()[m
[32m+[m[32mCONFIG_PATH = BASE_DIR / "config" / "config.toml"[m
[32m+[m
[32m+[m[32mclass Config:[m
[32m+[m[32m    def __init__(self) -> None:[m
[32m+[m[32m        if not CONFIG_PATH.exists():[m
[32m+[m[32m            raise FileNotFoundError(f"Configuration file not found at {CONFIG_PATH}")[m
[32m+[m
[32m+[m[32m        with open(CONFIG_PATH, "rb") as f:[m
[32m+[m[32m            self._data = tomllib.load(f)[m
[32m+[m
[32m+[m[32m    @property[m
[32m+[m[32m    def database(self) -> dict:[m
[32m+[m[32m        return self._data.get("DataBase", {})[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def query_columns(self) -> list[str]:[m
[32m+[m[32m        return self._data.get("QueryColumns", {}).get("columns", [])[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def maintenance_scenario(self) -> dict[int, str]:[m
[32m+[m[32m        raw = self._data.get("MaintenanceScenario", {})[m
[32m+[m[32m        return {int(k): v for k, v in raw.items()}[m
[32m+[m
[32m+[m[32m    @property[m
[32m+[m[32m    def maintenance_strategy(self) -> dict[int, str]:[m
[32m+[m[32m        raw = self._data.get("MaintenanceStrategy", {})[m
[32m+[m[32m        return {int(k): v for k, v in raw.items()}[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def solution(self) -> list[str]:[m
[32m+[m[32m        return self._data.get("Solutions", {}).get("patterns", [])[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def responsibility(self) -> dict[int, str]:[m
[32m+[m[32m        raw = self._data.get("Responsibility", {})[m
[32m+[m[32m        return {int(k): v for k, v in raw.items()}[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def file_name(self) -> str:[m
[32m+[m[32m        return self._data.get("Paths", {}).get("file_name", "ä¿®ç†æƒ…å ±.xlsx")[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def query_result_save_path(self) -> str:[m
[32m+[m[32m        query_result_save_path = self._data.get("Paths", {}).get("query_result_save_path", "")[m
[32m+[m[32m        if not os.path.exists(query_result_save_path):[m
[32m+[m[32m            os.makedirs(query_result_save_path)[m
[32m+[m[32m        return query_result_save_path[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def compress_file_save_path(self) -> str:[m
[32m+[m[32m        return self._data.get("Paths", {}).get("compress_file_save_path", self.query_result_save_path)[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def encrypt_file_save_path(self) -> str:[m
[32m+[m[32m        return self._data.get("Paths", {}).get("encrypt_file_save_path", self.query_result_save_path)[m
[32m+[m[41m    [m
[32m+[m[32m    @property[m
[32m+[m[32m    def download_file_save_path(self) -> str:[m
[32m+[m[32m        download_file_save_path = self._data.get("Paths", {}).get("download_f